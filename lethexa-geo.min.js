/*! lethexa-geo 2016-12-11 Copyright by Tim Leerhoff <tleerhof@web.de> */
!function(a){"use strict";a.Ellipsoid=function(a,b){var c=a*a,d=b*b,e=(c-d)/c;this.getRadiusAt=function(a){var b=c*c,e=d*d,f=a*Math.PI/180,g=Math.cos(f),h=Math.sin(f),i=g*g,j=h*h;return Math.sqrt((b*i+e*j)/(c*i+d*j))},this.a=function(){return a},this.b=function(){return b},this.a2=function(){return c},this.b2=function(){return d},this.e2=function(){return e},this.circumferenceA=function(){return 2*Math.PI*this.a},this.circumferenceB=function(){return 2*Math.PI*this.b}},a.EARTH=new a.Ellipsoid(6378137,6356752.3142),a.SUN=new a.Ellipsoid(13925e5,13925e5),a.MERCURY=new a.Ellipsoid(2439640,2439640),a.VENUS=new a.Ellipsoid(6051590,6051590),a.MOON=new a.Ellipsoid(3476e3,3476000.3142),a.MARS=new a.Ellipsoid(3399200,3399200),a.JUPITER=new a.Ellipsoid(71492680,71492680),a.SATURN=new a.Ellipsoid(60267140,60267140),a.URANUS=new a.Ellipsoid(25557250,25557250),a.NEPTUNE=new a.Ellipsoid(24766360,24766360),a.PLUTO=new a.Ellipsoid(1148070,1148070);var b=a.EARTH,c=.001,d=function(a){for(var b=2*Math.PI;a>=b;)a-=b;for(;0>a;)a+=b;return a},e=function(a){return[[a[0][0],a[1][0],a[2][0]],[a[0][1],a[1][1],a[2][1]],[a[0][2],a[1][2],a[2][2]]]};a.LatLonAlt=function(a,c,d,e){this._ellipsoid=e||b,this._lat=a,this._lon=c,this._alt=d,this._radLat=a*Math.PI/180,this._radLon=c*Math.PI/180,this._earthRadius=this._ellipsoid.getRadiusAt(a),this._sinLat=Math.sin(this._radLat),this._cosLat=Math.cos(this._radLat),this._sinLon=Math.sin(this._radLon),this._cosLon=Math.cos(this._radLon)},a.LatLonAlt.prototype.getEarthRadius=function(){return this._earthRadius},a.LatLonAlt.prototype.getLatitude=function(){return this._lat},a.LatLonAlt.prototype.getLongitude=function(){return this._lon},a.LatLonAlt.prototype.getAltitude=function(){return this._alt},a.LatLonAlt.prototype.getCenterWith=function(b,c){var d=(this.getLatitude()+b.getLatitude())/2,e=(this.getLongitude()+b.getLongitude())/2;return new a.LatLonAlt(d,e,c,this._ellipsoid)},a.LatLonAlt.prototype.extrapolateVector=function(b,c,d){var e=c/this._ellipsoid.a(),f=b/(this._cosLat*this._ellipsoid.b());return new a.LatLonAlt(this.getLatitude()+180*e/Math.PI,this.getLongitude()+180*f/Math.PI,this.getAltitude()+d,this._ellipsoid)},a.LatLonAlt.prototype.extrapolatePolar=function(b,c){if(0>b)throw new Error("distance should be >= 0.0, but is "+b);var d=b/this._earthRadius,e=Math.cos(c),f=Math.sin(c),g=Math.sin(d),h=Math.cos(d),i=Math.asin(this._sinLat*h+this._cosLat*g*e),j=Math.atan2(g*f,this._cosLat*h-this._sinLat*g*e)+this._radLon;return new a.LatLonAlt(180*i/Math.PI,180*j/Math.PI,this._alt,this._ellipsoid)},a.LatLonAlt.prototype.getDistanceTo=function(a){var b=Math.abs(a._radLat-this._radLat),c=Math.abs(a._radLon-this._radLon),d=Math.sin(b/2),e=Math.sin(c/2),f=d*d+this._cosLat*a._cosLat*e*e,g=2*Math.atan2(Math.sqrt(f),Math.sqrt(1-f));return this._earthRadius*g},a.LatLonAlt.prototype.getAzimutTo=function(a){var b=a._radLon-this._radLon,c=Math.sin(b),e=Math.cos(b),f=Math.atan2(a._cosLat*c,this._cosLat*a._sinLat-this._sinLat*a._cosLat*e);return d(f)},a.LatLonAlt.prototype.toLocalTransform=function(){return[[-this._sinLon,this._cosLon,0],[-this._sinLat*this._cosLon,-this._sinLat*this._sinLon,this._cosLat],[this._cosLat*this._cosLon,this._cosLat*this._sinLon,this._sinLat]]},a.LatLonAlt.prototype.toGlobalTransform=function(){return e(this.toLocalTransform())},a.LatLonAlt.prototype.toVec3=function(){var a=this._ellipsoid.a()/Math.sqrt(1-this._ellipsoid.e2()*this._sinLat*this._sinLat),b=(a+this._alt)*this._cosLat*this._cosLon,c=(a+this._alt)*this._cosLat*this._sinLon,d=((1-this._ellipsoid.e2())*a+this._alt)*this._sinLat;return[b,c,d]},a.fromVec3=function(d,e){var f,g,h,i=e||b,j=d[0],k=d[1],l=d[2],m=0,n=Math.atan2(k,j),o=0,p=Math.sqrt(j*j+k*k),q=Math.sin(m),r=Math.cos(m);do f=m,g=o,h=i.a()/Math.sqrt(1-i.e2()*q*q),m=Math.atan((l-o*i.e2()*q)/(p*(1-i.e2()))),q=Math.sin(m),r=Math.cos(m),o=p/r-h;while(Math.abs(f-m)>c||Math.abs(g-o)>c);return new a.LatLonAlt(180*m/Math.PI,180*n/Math.PI,o,i)},a.LatLonAlt.prototype.toString=function(){return""+this._lat+"°, "+this._lon+"°, "+this._alt+"m"};var f=function(a,b){var c=""+a,d=Math.pow(10,b-1);if(1>=b)return c;for(;1!==d;)c=(d>a?"0":"")+c,d/=10;return c},g=function(a,b){var c=Math.pow(10,b);return Math.floor(a*c)/c},h=function(a){var b,c;a=Math.abs(a),c=Math.floor(a);var d=c;b=a-c,a=60*b,c=Math.floor(a);var e=c;b=a-c,a=60*b,c=Math.floor(a);var f=a;return{deg:d,min:e,sec:f}};a.cvtLatitudeToDegMinSec=function(a){var b=h(Math.abs(a)),c="";return c+=f(b.deg,2)+"° ",c+=f(b.min,2)+"' ",c+=f(g(b.sec,2),2)+"''",a>=0?c+" N":c+" S"},a.cvtLongitudeToDegMinSec=function(a){var b=h(Math.abs(a)),c="";return c+=f(b.deg,3)+"° ",c+=f(b.min,2)+"' ",c+=f(g(b.sec,2),2)+"''",a>=0?c+" E":c+" W"},a.cvtLatitudeToDecimalDegrees=function(a,b){if(void 0===b)throw Error("frac is missing");var c=g(Math.abs(a),b)+"°";return a>=0?c+" N":c+" S"},a.cvtLongitudeToDecimalDegrees=function(a,b){if(void 0===b)throw Error("frac is missing");var c=g(Math.abs(a),b)+"°";return a>=0?c+" E":c+" W"}}("undefined"==typeof exports?this.geo={}:exports);